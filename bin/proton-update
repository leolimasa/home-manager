#!/usr/bin/env bash
set -e
set -x
mkdir -p ~/.steam/root/compatibilitytools.d
rm -rf ~/.steam/root/compatibilitytools.d/*

cd ~/.steam/root/compatibilitytools.d

# Download tarball
download_url=$(curl -s https://api.github.com/repos/GloriousEggroll/proton-ge-custom/releases/latest | grep browser_download_url | cut -d\" -f4 | egrep .tar.gz)
wget $download_url

# Download checksum
checksum_url=$(curl -s https://api.github.com/repos/GloriousEggroll/proton-ge-custom/releases/latest | grep browser_download_url | cut -d\" -f4 | egrep .sha512sum)
wget $checksum_url

# check tarball with checksum
sha512sum -c *.sha512sum

# extract
tar -xvzf *.tar.gz
